{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://portal-universe/contracts/error-response.schema.json",
  "title": "ErrorResponse",
  "description": "Standardized error object inside ApiResponse.error. Java: ErrorResponse, NestJS: ErrorInfo, Python: ErrorDetail",
  "type": "object",
  "required": ["code", "message"],
  "properties": {
    "code": {
      "type": "string",
      "pattern": "^[A-Z]{1,2}[0-9]{2,4}$",
      "description": "Service-prefixed error code. Pattern: <PREFIX><DIGITS>. See error-codes.md for namespace allocation.",
      "examples": ["C001", "A001", "S201", "P006", "CH01"]
    },
    "message": {
      "type": "string",
      "description": "Human-readable error message (may be shown to end users)"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO-8601 timestamp of when the error occurred. SHOULD be included in all responses."
    },
    "path": {
      "type": "string",
      "description": "Request path that triggered the error. SHOULD be included when available.",
      "examples": ["/api/v1/products", "/api/v1/chat/stream"]
    },
    "details": {
      "type": "array",
      "description": "Field-level validation errors. MUST be included for validation failures (HTTP 400/422).",
      "items": {
        "type": "object",
        "required": ["field", "message"],
        "properties": {
          "field": {
            "type": "string",
            "description": "Field name or path that failed validation",
            "examples": ["email", "items[0].quantity", "body.price"]
          },
          "message": {
            "type": "string",
            "description": "Validation failure message for this field"
          },
          "rejectedValue": {
            "description": "The value that was rejected (any type, optional)"
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "code": "C001",
      "message": "Internal Server Error",
      "timestamp": "2026-02-13T10:30:00Z",
      "path": "/api/v1/products"
    },
    {
      "code": "C002",
      "message": "Invalid Input Value",
      "timestamp": "2026-02-13T10:30:00Z",
      "path": "/api/v1/orders",
      "details": [
        { "field": "email", "message": "must not be blank", "rejectedValue": "" },
        { "field": "quantity", "message": "must be greater than 0", "rejectedValue": -1 }
      ]
    }
  ]
}

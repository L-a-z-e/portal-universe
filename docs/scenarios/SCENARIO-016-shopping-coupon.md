---
id: SCENARIO-016
title: 쿠폰 발급 및 체크아웃 적용
type: scenario
status: current
created: 2026-01-31
updated: 2026-01-31
author: Laze
tags:
  - coupon
  - checkout
  - discount
  - e2e
related:
  - SCENARIO-001-coupon-issue
  - PRD-002-concurrency
---

# SCENARIO-016: 쿠폰 발급 및 체크아웃 적용

## Overview

사용자가 **쿠폰 목록에서 쿠폰을 발급**받고, **체크아웃 과정에서 쿠폰을 적용**하여 할인된 가격으로 주문을 완료하는 E2E 시나리오입니다.

---

## Actors

| Actor | 역할 | 책임 |
|-------|------|------|
| **사용자** | 쿠폰 발급 및 사용 | 쿠폰 발급, 체크아웃 적용 |
| **Shopping Service** | 비즈니스 로직 | 쿠폰 유효성 검증, 할인 적용 |

---

## Preconditions

- 사용자가 로그인된 상태
- 발급 가능한 쿠폰이 1개 이상 존재
- 장바구니에 상품이 1개 이상 존재

---

## Flow

### 메인 시나리오: 쿠폰 발급 → 체크아웃 적용

```
1. 사용자가 /coupons 페이지 접속
2. "발급 가능한 쿠폰" 탭에서 쿠폰 목록 확인
3. 원하는 쿠폰의 "발급" 버튼 클릭
4. 발급 성공 메시지 확인
5. "내 쿠폰함" 탭으로 전환
6. 발급받은 쿠폰이 "사용 가능" 상태로 표시 확인
7. 장바구니 → 체크아웃 진행
8. 배송 주소 입력 후 쿠폰 선택기에서 쿠폰 적용
9. 할인 금액이 주문 요약에 반영 확인
10. 결제 완료
11. 주문 완료 화면에서 할인 적용 확인
```

### 대안 시나리오: 이미 발급받은 쿠폰

```
1. 사용자가 /coupons 페이지 접속
2. 이미 발급받은 쿠폰은 "발급 완료" 상태로 표시
3. 발급 버튼 비활성화 확인
```

### 대안 시나리오: 쿠폰 재고 소진

```
1. 사용자가 쿠폰 발급 시도
2. 재고 소진 시 에러 메시지 표시
3. 쿠폰 상태가 EXHAUSTED로 변경
```

---

## API Endpoints

| HTTP | Endpoint | 설명 |
|------|----------|------|
| GET | `/coupons` | 발급 가능한 쿠폰 목록 |
| POST | `/coupons/{couponId}/issue` | 쿠폰 발급 |
| GET | `/coupons/my` | 내 쿠폰 목록 |
| GET | `/coupons/my/available` | 사용 가능 쿠폰 목록 |

---

## E2E Test Cases

| TC | 설명 | 우선순위 |
|----|------|---------|
| TC-016-01 | 쿠폰 목록 페이지 로드 | P1 |
| TC-016-02 | 쿠폰 발급 성공 | P1 |
| TC-016-03 | 내 쿠폰함 조회 | P1 |
| TC-016-04 | 체크아웃에서 쿠폰 적용 | P1 |
| TC-016-05 | 중복 발급 방지 | P2 |
| TC-016-06 | 쿠폰 상태별 표시 (AVAILABLE/USED/EXPIRED) | P2 |

---

## Verification Points

- [ ] /coupons 페이지 정상 렌더링
- [ ] 쿠폰 목록 API 데이터 로드
- [ ] 쿠폰 발급 버튼 동작
- [ ] 내 쿠폰함 탭 전환
- [ ] 체크아웃 CouponSelector 동작
- [ ] 할인 금액 계산 정확성

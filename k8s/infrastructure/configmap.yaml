# ===================================================================
# ConfigMap: 공통 환경 변수 설정
# ===================================================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: portal-universe-config
  namespace: portal-universe
data:
  # 모든 Spring Boot 애플리케이션에 'kubernetes' 프로파일을 활성화합니다.
  SPRING_PROFILES_ACTIVE: "kubernetes"

  # --- 서비스 디스커버리 ---
  # 모든 서비스가 등록하고 찾을 Eureka 서버의 주소입니다.
  EUREKA_CLIENT_SERVICEURL_DEFAULTZONE: "http://discovery-service:8761/eureka/"
  # Eureka에 서비스 등록 시, 호스트 이름 대신 IP 주소를 사용하도록 합니다.
  EUREKA_INSTANCE_PREFER_IP_ADDRESS: "true"

  # --- 분산 추적 (Distributed Tracing) ---
  # 추적 데이터를 수집할 Zipkin 서버의 주소입니다.
  MANAGEMENT_ZIPKIN_TRACING_ENDPOINT: "http://zipkin:9411/api/v2/spans"
  # 모든 요청을 추적하도록 샘플링 비율을 100%로 설정합니다.
  MANAGEMENT_TRACING_SAMPLING_PROBABILITY: "1.0"

  # --- 모니터링 ---
  # Prometheus, Health Check 등 모니터링에 필요한 Actuator 엔드포인트를 외부에 노출합니다.
  MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE: "health,info,prometheus,metrics"

  # --- 기타 ---
  # 모든 컨테이너의 타임존을 서울로 설정합니다.
  TZ: "Asia/Seoul"
---
# ===================================================================
# ConfigMap: MySQL 초기 설정
# ===================================================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: mysql-config
  namespace: portal-universe
data:
  MYSQL_ROOT_PASSWORD: "root"
  MYSQL_USER: "laze"
  MYSQL_PASSWORD: "password"
---
# ===================================================================
# ConfigMap: MongoDB 초기 설정
# ===================================================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: mongodb-config
  namespace: portal-universe
data:
  MONGO_INITDB_ROOT_USERNAME: "laze"
  MONGO_INITDB_ROOT_PASSWORD: "password"
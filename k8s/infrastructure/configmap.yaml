# ===================================================================
# ConfigMap: 공통 환경 변수 설정
# ===================================================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: portal-universe-config
  namespace: portal-universe
data:
  # 모든 Spring Boot 애플리케이션에 'kubernetes' 프로파일을 활성화합니다.
  SPRING_PROFILES_ACTIVE: "kubernetes"

  # --- 메시지 브로커 ---
  # Kafka 브로커의 주소입니다.
  KAFKA_BOOTSTRAP_SERVERS: "kafka:29092"

  # --- Elasticsearch ---
  ELASTICSEARCH_URIS: "http://elasticsearch:9200"

  # --- Redis ---
  REDIS_HOST: "redis"
  REDIS_PORT: "6379"

  # --- 데이터베이스 ---
  # MySQL 호스트 주소입니다.
  MYSQL_HOST: "mysql-db"
  # MongoDB 호스트 주소입니다.
  MONGODB_HOST: "mongodb"
  # DB 공통 환경변수 (Spring Boot에서 사용)
  DB_HOST: "mysql-db"
  DB_PORT: "3306"
  DB_USERNAME: "laze"

  # --- 분산 추적 (Distributed Tracing) ---
  # 추적 데이터를 수집할 Zipkin 서버의 주소입니다.
  MANAGEMENT_ZIPKIN_TRACING_ENDPOINT: "http://zipkin:9411/api/v2/spans"
  # 모든 요청을 추적하도록 샘플링 비율을 100%로 설정합니다.
  MANAGEMENT_TRACING_SAMPLING_PROBABILITY: "1.0"

  # --- 모니터링 ---
  # Prometheus, Health Check 등 모니터링에 필요한 Actuator 엔드포인트를 외부에 노출합니다.
  MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE: "health,info,prometheus,metrics"

  # --- 기타 ---
  # 모든 컨테이너의 타임존을 서울로 설정합니다.
  TZ: "Asia/Seoul"
---
# ===================================================================
# ConfigMap: MySQL 초기 설정
# ===================================================================
# NOTE: Password fields moved to Secret (k8s/base/secret.yaml)
apiVersion: v1
kind: ConfigMap
metadata:
  name: mysql-config
  namespace: portal-universe
data:
  MYSQL_USER: "laze"
---
# ===================================================================
# ConfigMap: MongoDB 초기 설정
# ===================================================================
# NOTE: Password fields moved to Secret (k8s/base/secret.yaml)
apiVersion: v1
kind: ConfigMap
metadata:
  name: mongodb-config
  namespace: portal-universe
data:
  MONGO_INITDB_ROOT_USERNAME: "laze"
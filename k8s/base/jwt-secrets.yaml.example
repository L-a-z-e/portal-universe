# ===================================================================
# JWT Secret Keys Configuration (Example)
# ===================================================================
#
# 이 파일은 JWT Secret Key 관리를 위한 예제입니다.
# 실제 사용 시 아래 단계를 따르세요:
#
# 1. 이 파일을 복사하여 jwt-secrets.yaml 생성:
#    cp jwt-secrets.yaml.example jwt-secrets.yaml
#
# 2. 새 키 생성 (256-bit 이상):
#    openssl rand -base64 32
#
# 3. 생성된 키를 JWT_SECRET_KEY_* 값에 입력
#
# 4. Kubernetes Secret 생성:
#    kubectl apply -f jwt-secrets.yaml
#
# ⚠️ 주의: jwt-secrets.yaml은 .gitignore에 포함되어 있으며,
#           절대 Git에 커밋하지 마세요!
# ===================================================================

apiVersion: v1
kind: Secret
metadata:
  name: jwt-secrets
  namespace: portal-universe
  labels:
    app: portal-universe
    component: auth
type: Opaque
stringData:
  # 현재 사용 중인 키 ID (환경 변수)
  JWT_CURRENT_KEY_ID: "key-2026-01"

  # 현재 활성화된 키 (2024년 1월부터 사용)
  JWT_SECRET_KEY_2024_01: "CHANGE_THIS_TO_YOUR_ACTUAL_256_BIT_SECRET_KEY_2024_01"

  # 이전 키 (검증용으로만 사용, 2024년 2월 1일까지 유효)
  # 키 교체 시 이전 키는 일정 기간(토큰 만료 기간 + 버퍼) 유지
  # JWT_SECRET_KEY_2023_12: "YOUR_OLD_SECRET_KEY_FROM_2023_12"

---
# ===================================================================
# JWT Rotation ConfigMap
# ===================================================================
#
# 키 설정 정보를 담은 ConfigMap
# Secret에는 민감한 키 값만, 메타데이터는 ConfigMap에 저장
# ===================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: jwt-rotation-config
  namespace: portal-universe
  labels:
    app: portal-universe
    component: auth
data:
  # 키 활성화/만료 시간 정보
  key-2026-01.activated-at: "2026-01-01T00:00:00"
  # key-2026-01.expires-at: ""  # 만료 없음

  # key-2025-12.activated-at: "2025-12-01T00:00:00"
  # key-2025-12.expires-at: "2026-02-01T00:00:00"  # 2개월 후 만료
